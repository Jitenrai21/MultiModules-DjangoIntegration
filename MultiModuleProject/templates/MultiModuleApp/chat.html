{% extends 'MultiModuleApp/base.html' %}
{% load static %}
{% block title %}Gemini Chatbot - Jiten Rai{% endblock %}
{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 fade-in">
    <div class="bg-white p-6 rounded-lg shadow-lg max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Gemini Chatbot</h1>
        <div class="mb-4">
            <label for="persona" class="block text-sm font-medium text-gray-700">Select Persona:</label>
            <select id="persona" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-blue-400 focus:border-blue-400">
                <option value="Isaac Newton">Isaac Newton - Mathematician and physicist</option>
                <option value="Marie Curie">Marie Curie - Pioneering scientist in radioactivity</option>
                <option value="William Shakespeare">William Shakespeare - English playwright and poet</option>
                <option value="Adam Smith">Adam Smith - Father of modern economics</option>
                <option value="Alan Turing">Alan Turing - Father of computer science</option>
            </select>
        </div>
        <div class="mb-4">
            <label for="enable-speech" class="flex items-center text-sm font-medium text-gray-700">
                <input type="checkbox" id="enable-speech" class="mr-2 h-4 w-4 text-blue-400 focus:ring-blue-400 border-gray-300 rounded">
                Enable Text-to-Speech Output
            </label>
        </div>
        <div class="chat-container border border-gray-200 p-4 rounded-md bg-gray-50 mb-4 max-h-96 overflow-y-auto">
            <div id="chat-output"></div>
        </div>
        <div class="flex space-x-2">
            <input type="text" id="user-input" class="flex-1 p-2 border border-gray-300 rounded-md focus:ring-blue-400 focus:border-blue-400" placeholder="Type your message...">
            <button id="send-btn" class="p-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">Send</button>
            <button id="mic-btn" class="p-2 bg-gray-500 text-white rounded-md hover:bg-gray-600" title="Use voice input">üéôÔ∏è</button>
        </div>
        <p id="error-message" class="text-red-500 mt-2 hidden"></p>
        <p id="voice-status" class="text-gray-600 mt-2 hidden"></p>
        <p id="speech-support" class="text-gray-600 mt-2 hidden"></p>
    </div>
</div>
<script src="{% static 'chat.js' %}?v=1" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        console.log("DOM loaded, initializing chatAPI");
        if (window.chatAPI && typeof window.chatAPI.init === "function") {
            window.chatAPI.init();
        } else {
            console.error("chatAPI not available");
            document.getElementById("error-message").textContent = "Failed to load chat functionality. Please refresh the page.";
            document.getElementById("error-message").classList.remove("hidden");
        }
    });
</script>
{% endblock %}